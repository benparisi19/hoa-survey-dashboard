# HOA Survey Analysis Dashboard

A modern web dashboard for analyzing HOA landscaping survey responses, built with Next.js and deployed on Vercel.

## ğŸš€ Features

- **Interactive Dashboard** - Key metrics and visualizations
- **Response Browser** - Search and filter survey responses  
- **PDF Viewer** - View original survey PDFs side-by-side with responses
- **PDF Upload** - Drag-and-drop PDF uploads when editing
- **Notes Management** - Track and manage marginal notes from surveys
- **Analysis Tools** - Charts and detailed breakdowns
- **Export Capabilities** - Download data as CSV
- **Review Workflow** - Quality control system for data validation
- **Mobile Responsive** - Works on all devices
- **Real-time Data** - Connected to Supabase database

## ğŸ› ï¸ Tech Stack

- **Frontend**: Next.js 14 (App Router), TypeScript, Tailwind CSS
- **Database**: Supabase (PostgreSQL)
- **Storage**: Supabase Storage for PDF files
- **Charts**: Recharts
- **Deployment**: Vercel
- **Domain**: Custom domain via Porkbun

## ğŸ“‹ Prerequisites

1. **Supabase Project** - Database with survey data imported
2. **Vercel Account** - For hosting (free tier)
3. **Porkbun Domain** - For custom domain (optional)
4. **Node.js 18+** - For local development

## ğŸ”§ Local Development

1. **Clone the repository**:
   ```bash
   git clone <your-repo-url>
   cd web-portal
   ```

2. **Install dependencies**:
   ```bash
   npm install
   ```

3. **Configure environment variables**:
   ```bash
   cp .env.example .env
   # Edit .env with your Supabase credentials
   ```

4. **Run the development server**:
   ```bash
   npm run dev
   ```

5. **Open** [http://localhost:3000](http://localhost:3000)

## ğŸ“ Available Scripts

```bash
npm run dev              # Start development server
npm run build            # Build for production
npm run type-check       # Validate TypeScript
npm run lint             # Check code quality
npm run bulk-update-pdfs # Bulk link PDFs to database records
```

### Utility Scripts (in scripts/ directory):
- `check-response-ids.js` - Verify response ID formats
- `check-specific-response.js` - Debug specific response data
- `verify_notes_import.js` - Verify notes extraction results
- `extract_and_import_notes.js` - Import marginal notes to database

## ğŸŒ Deployment to Vercel

### Option 1: GitHub Integration (Recommended)

1. **Push to GitHub**:
   ```bash
   git add .
   git commit -m "Initial commit"
   git push origin main
   ```

2. **Connect to Vercel**:
   - Go to [vercel.com](https://vercel.com)
   - Click "Import Project"
   - Select your GitHub repository
   - Vercel will auto-detect Next.js

3. **Configure Environment Variables**:
   In Vercel dashboard > Settings > Environment Variables:
   ```
   NEXT_PUBLIC_SUPABASE_URL = your-supabase-url
   NEXT_PUBLIC_SUPABASE_ANON_KEY = your-anon-key
   SUPABASE_SERVICE_KEY = your-service-key
   ```

4. **Deploy**: Vercel will automatically build and deploy

### Option 2: Vercel CLI

1. **Install Vercel CLI**:
   ```bash
   npm i -g vercel
   ```

2. **Deploy**:
   ```bash
   vercel
   # Follow the prompts
   ```

## ğŸ”— Custom Domain Setup (Porkbun)

1. **Add Domain in Vercel**:
   - Go to Project Settings > Domains
   - Add your domain (e.g., `survey.yourdomain.com`)

2. **Configure DNS in Porkbun**:
   - Add A record: `@` â†’ `76.76.19.61` (Vercel IP)
   - Add CNAME: `www` â†’ `your-app.vercel.app`
   - Add CNAME: `survey` â†’ `your-app.vercel.app` (for subdomain)

3. **SSL Certificate**: Automatically generated by Vercel

## ğŸ“Š Database Setup

Make sure you've run the Supabase setup scripts:

1. **Create tables**: Run `../database/supabase_schema.sql`
2. **Import data**: Run `../database/supabase_data_import.sql`
3. **Test connection**: Run `../scripts/test_connection.py`

## ğŸ”’ Security

- Environment variables are secure in Vercel
- Only anon key is exposed to frontend
- Row Level Security enabled in Supabase
- Security headers configured

## ğŸ“ˆ Performance

- Static generation where possible
- Image optimization (Next.js built-in)
- Code splitting (automatic)
- Global CDN (Vercel)
- Caching strategies for database queries

## ğŸ› Troubleshooting

### Build Errors
```bash
npm run build
# Check for TypeScript errors
npm run type-check
```

### Database Connection
```bash
# Test your Supabase connection
cd ../scripts
python test_connection.py
```

### Environment Variables
- Make sure all required env vars are set in Vercel
- Check that Supabase keys are correct
- Verify database password is correct

## ğŸ“ Support

- **Vercel Docs**: [vercel.com/docs](https://vercel.com/docs)
- **Next.js Docs**: [nextjs.org/docs](https://nextjs.org/docs)
- **Supabase Docs**: [supabase.com/docs](https://supabase.com/docs)

## ğŸ¯ Post-Deployment Checklist

- [ ] Dashboard loads without errors
- [ ] Charts display survey data
- [ ] All 113 responses are visible
- [ ] Export functionality works
- [ ] Mobile view is responsive
- [ ] Custom domain resolves correctly
- [ ] SSL certificate is active
- [ ] Analytics are working (optional)

Your HOA survey dashboard is now live and accessible to board members!