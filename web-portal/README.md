# HOA Community Management Platform

A comprehensive property-centric platform for managing HOA operations, built with Next.js and deployed on Vercel.

## 🚀 Features

- **Property Management** - Complete directory of 232 HOA properties with resident tracking
- **Interactive Mapping** - Mapbox integration with zone visualization and geocoded properties
- **Zone Analytics** - Zone-based management with performance insights
- **Resident Directory** - Property relationships and contact management
- **Multi-Survey Platform** - Expandable survey system beyond landscaping
- **Advanced Filtering** - Sophisticated property and resident filtering with saved presets
- **Executive Dashboard** - Neighborhood overview with community health metrics
- **Mobile Responsive** - Optimized for all devices with responsive design
- **Real-time Data** - Connected to property-centric Supabase database

## 🛠️ Tech Stack

- **Frontend**: Next.js 14 (App Router), TypeScript, Tailwind CSS
- **Database**: Supabase (PostgreSQL) with property-centric schema
- **Mapping**: Mapbox GL JS with geocoding for 232 properties
- **Storage**: Supabase Storage for PDF files and documents
- **Charts**: Recharts for analytics and zone insights
- **Authentication**: Supabase Auth with admin-only access
- **Deployment**: Vercel with automatic deployments
- **Domain**: Custom domain via Porkbun

## 📋 Prerequisites

1. **Supabase Project** - Property-centric database with 232 properties and residents
2. **Mapbox Account** - For mapping and geocoding features
3. **Vercel Account** - For hosting (free tier)
4. **Porkbun Domain** - For custom domain (optional)
5. **Node.js 18+** - For local development

## 🔧 Local Development

1. **Clone the repository**:
   ```bash
   git clone <your-repo-url>
   cd web-portal
   ```

2. **Install dependencies**:
   ```bash
   npm install
   ```

3. **Configure environment variables**:
   ```bash
   cp .env.example .env
   # Edit .env with your credentials:
   # NEXT_PUBLIC_SUPABASE_URL, SUPABASE_SERVICE_KEY
   # NEXT_PUBLIC_MAPBOX_ACCESS_TOKEN
   ```

4. **Run the development server**:
   ```bash
   npm run dev
   ```

5. **Open** [http://localhost:3000](http://localhost:3000)

## 📝 Available Scripts

```bash
npm run dev                      # Start development server
npm run build                    # Build for production
npm run type-check               # Validate TypeScript
npm run lint                     # Check code quality
node scripts/geocode-properties.js        # Geocode property addresses
node scripts/geocode-properties.js stats  # Show geocoding statistics
```

### Utility Scripts (in scripts/ directory):
- `geocode-properties.js` - Geocode all property addresses for mapping
- `check-response-ids.js` - Verify response ID formats
- `check-specific-response.js` - Debug specific response data
- `verify_notes_import.js` - Verify notes extraction results

## 🌐 Deployment to Vercel

### Option 1: GitHub Integration (Recommended)

1. **Push to GitHub**:
   ```bash
   git add .
   git commit -m "Initial commit"
   git push origin main
   ```

2. **Connect to Vercel**:
   - Go to [vercel.com](https://vercel.com)
   - Click "Import Project"
   - Select your GitHub repository
   - Vercel will auto-detect Next.js

3. **Configure Environment Variables**:
   In Vercel dashboard > Settings > Environment Variables:
   ```
   NEXT_PUBLIC_SUPABASE_URL = your-supabase-url
   NEXT_PUBLIC_SUPABASE_ANON_KEY = your-anon-key
   SUPABASE_SERVICE_KEY = your-service-key
   NEXT_PUBLIC_MAPBOX_ACCESS_TOKEN = your-mapbox-token
   ```

4. **Deploy**: Vercel will automatically build and deploy

### Option 2: Vercel CLI

1. **Install Vercel CLI**:
   ```bash
   npm i -g vercel
   ```

2. **Deploy**:
   ```bash
   vercel
   # Follow the prompts
   ```

## 🔗 Custom Domain Setup (Porkbun)

1. **Add Domain in Vercel**:
   - Go to Project Settings > Domains
   - Add your domain (e.g., `survey.yourdomain.com`)

2. **Configure DNS in Porkbun**:
   - Add A record: `@` → `76.76.19.61` (Vercel IP)
   - Add CNAME: `www` → `your-app.vercel.app`
   - Add CNAME: `survey` → `your-app.vercel.app` (for subdomain)

3. **SSL Certificate**: Automatically generated by Vercel

## 📊 Database Setup

Make sure you've run the Supabase setup scripts:

1. **Create tables**: Run `../database/supabase_schema.sql`
2. **Import data**: Run `../database/supabase_data_import.sql`
3. **Test connection**: Run `../scripts/test_connection.py`

## 🔒 Security

- Environment variables are secure in Vercel
- Only anon key is exposed to frontend
- Row Level Security enabled in Supabase
- Security headers configured

## 📈 Performance

- Static generation where possible
- Image optimization (Next.js built-in)
- Code splitting (automatic)
- Global CDN (Vercel)
- Caching strategies for database queries

## 🐛 Troubleshooting

### Build Errors
```bash
npm run build
# Check for TypeScript errors
npm run type-check
```

### Database Connection
```bash
# Test your Supabase connection
cd ../scripts
python test_connection.py
```

### Environment Variables
- Make sure all required env vars are set in Vercel
- Check that Supabase keys are correct
- Verify database password is correct

## 📞 Support

- **Vercel Docs**: [vercel.com/docs](https://vercel.com/docs)
- **Next.js Docs**: [nextjs.org/docs](https://nextjs.org/docs)
- **Supabase Docs**: [supabase.com/docs](https://supabase.com/docs)

## 🎯 Post-Deployment Checklist

- [ ] Dashboard loads without errors
- [ ] Property directory shows all 232 properties
- [ ] Interactive map displays with zone-colored markers
- [ ] Property detail pages show resident information
- [ ] Zone analytics display correctly
- [ ] Neighborhood dashboard shows community metrics
- [ ] Advanced filtering works with all property criteria
- [ ] Mobile view is responsive across all pages
- [ ] Custom domain resolves correctly
- [ ] SSL certificate is active

Your HOA community management platform is now live and operational!